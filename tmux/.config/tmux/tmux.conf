# ==========================================
# 0. CORE SETTINGS (T·ªëi ∆∞u hi·ªáu nƒÉng)
# ==========================================

# Prefix key: ƒê·ªïi t·ª´ Ctrl+b sang Ctrl+Space (B·∫•m s∆∞·ªõng tay h∆°n nhi·ªÅu)
unbind C-b
set -g prefix C-Space
bind C-Space send-prefix

# Fix l·ªói delay khi b·∫•m ph√≠m Esc trong Neovim/Vim
set -s escape-time 0

# TƒÉng gi·ªõi h·∫°n l·ªãch s·ª≠ cu·ªôn (Scrollback history)
set -g history-limit 50000

# H·ªó tr·ª£ m√†u TrueColor (24-bit) cho Neovim ƒë·∫πp
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"

# B·∫≠t chu·ªôt (ƒë·ªÉ resize pane ho·∫∑c ch·ªçn tab nhanh khi l∆∞·ªùi)
set -g mouse on

# T·ª± ƒë·ªông ƒë√°nh s·ªë l·∫°i window khi ƒë√≥ng (1, 3, 4 -> 1, 2, 3)
set -g renumber-windows on

# ==========================================
# 1. NAVIGATION & PANES (Vim-like)
# ==========================================

# B·∫Øt ƒë·∫ßu ƒë√°nh s·ªë t·ª´ 1 thay v√¨ 0 (Ph√≠m 0 n·∫±m xa qu√°)
set -g base-index 1
setw -g pane-base-index 1

# new session
# T·∫°o Session m·ªõi nhanh: B·∫•m Prefix + S (Shift + s)
bind S command-prompt -p "New Session:" "new-session -A -s '%%'"

# Chia m√†n h√¨nh: D√πng | v√† - (Tr·ª±c quan h∆°n % v√† ")
# Th√™m -c "#{pane_current_path}" ƒë·ªÉ m·ªü pane m·ªõi ngay t·∫°i th∆∞ m·ª•c hi·ªán t·∫°i
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# Di chuy·ªÉn gi·ªØa c√°c Pane b·∫±ng h, j, k, l (Thay v√¨ m≈©i t√™n)
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Resize Pane b·∫±ng Shift + h, j, k, l
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Reload config nhanh b·∫±ng ph√≠m r
bind r source-file ~/.config/tmux/tmux.conf \; display "Config Reloaded!"

# ==========================================
# 2. COPY MODE (Vi-mode chu·∫©n ch·ªâ)
# ==========================================

# S·ª≠ d·ª•ng ph√≠m t·∫Øt vi trong ch·∫ø ƒë·ªô copy ([)
set-window-option -g mode-keys vi

# G√°n ph√≠m v ƒë·ªÉ b·∫Øt ƒë·∫ßu ch·ªçn, y ƒë·ªÉ copy (Gi·ªëng h·ªát Vim)
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel

# ==========================================
# 3. UI / AESTHETICS (T·ªëi gi·∫£n - Kh√¥ng ƒÉn RAM)
# ==========================================

# ƒê∆∞a thanh tr·∫°ng th√°i l√™n tr√™n c√πng (Gi·ªëng Tab tr√¨nh duy·ªát)
set-option -g status-position bottom 

# M√†u s·∫Øc n·ªÅn n√£, kh√¥ng l√≤e lo·∫πt
set -g status-style bg=default,fg=white
set -g status-justify left
set -g status-left-length 50

# Status Left: Hi·ªÉn th·ªã Session Name V√Ä Prefix Indicator
set -g status-left "#{?client_prefix,#[bg=yellow]#[fg=black]#[bold] üöÄ COMMAND #[bg=default]#[fg=default] ,#[fg=blue,bold] ‚ùê #S }#[fg=white,nobold]| "

# Status Right: Hi·ªán t√™n m√°y (Hostname) - ƒê∆°n gi·∫£n
set -g status-right "#[fg=cyan] %H:%M "

# Window inactive: M√†u x√°m, hi·ªÉn th·ªã index v√† t√™n
set -g window-status-format "#[fg=gray]#I:#W "

# Window active: M√†u tr·∫Øng s√°ng, in ƒë·∫≠m
set -g window-status-current-format "#[fg=white,bold]#I:#W "

# Vi·ªÅn pane active (Cho d·ªÖ nh√¨n ƒëang ·ªü ƒë√¢u)
set -g pane-active-border-style fg=blue

# ==========================================
# 2. COPY MODE (Vi-mode chu·∫©n ch·ªâ & System Clipboard)
# ==========================================

# S·ª≠ d·ª•ng ph√≠m t·∫Øt vi trong ch·∫ø ƒë·ªô copy ([)
set-window-option -g mode-keys vi

# G√°n ph√≠m v ƒë·ªÉ b·∫Øt ƒë·∫ßu ch·ªçn (Gi·ªëng Vim)
bind-key -T copy-mode-vi v send-keys -X begin-selection

# --- S·ª¨A ƒê·ªîI ƒê·ªÇ COPY RA SYSTEM CLIPBOARD (X11) ---

# 1. Khi b·∫•m y: Copy v√†o clipboard h·ªá th·ªëng thay v√¨ ch·ªâ tmux buffer
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "xclip -selection clipboard -i"

# 2. Khi b√¥i ƒëen b·∫±ng chu·ªôt v√† th·∫£ ra: T·ª± ƒë·ªông copy v√† tho√°t mode (Gi·ªëng st/terminal th∆∞·ªùng)
bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "xclip -selection clipboard -i"

# (T√πy ch·ªçn) Gi·ªØ v√πng ch·ªçn sau khi th·∫£ chu·ªôt (kh√¥ng tho√°t copy mode ngay), n·∫øu th√≠ch th√¨ d√πng d√≤ng d∆∞·ªõi thay cho d√≤ng tr√™n:
# bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe "xclip -selection clipboard -i"
